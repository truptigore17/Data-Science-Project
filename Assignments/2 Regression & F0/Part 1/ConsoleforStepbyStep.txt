> require(XLConnect)
> df = loadWorkbook("ChemicalProcessData.xlsx")
> ChemicalProcessData = readWorksheet(df, sheet = "ChemicalProcessData", header = TRUE)
> Mat_ChemicalProcessData<-as.matrix(ChemicalProcessData)
> Identity_Mat<-diag(17)
> 
> Matx_Xtnd<-as.matrix(cbind(1,ChemicalProcessData))
> Matx_X<-Matx_Xtnd[,c(1,3,4)]
> Matx_X #Matrix X
      1 Factor_1 Factor_2
 [1,] 1     41.9     29.1
 [2,] 1     43.4     29.3
 [3,] 1     43.9     29.5
 [4,] 1     44.5     29.7
 [5,] 1     47.3     29.9
 [6,] 1     47.5     30.3
 [7,] 1     47.9     30.5
 [8,] 1     50.2     30.7
 [9,] 1     52.8     30.8
[10,] 1     53.2     30.9
[11,] 1     56.7     31.5
[12,] 1     57.0     31.7
[13,] 1     63.5     31.9
[14,] 1     65.3     32.0
[15,] 1     71.1     32.1
[16,] 1     77.0     32.5
[17,] 1     77.8     32.9
> Matx_Y<-Matx_Xtnd[,c(5)]
> Matx_Y #Matrix Y
 [1] 251.3 251.3 248.3 267.5 273.0 276.5 270.3 274.9 285.0 290.0 297.0 302.5 304.5
[14] 309.3 321.7 330.7 349.0
> Matx_X_t<-t(Matx_X) #Transpose of X
> Matx_Y_t<-t(Matx_Y)  #Transpose of Y
> Matx_XtX<-Matx_X_t%*%Matx_X
> library(MASS) #import library
> Matx_XtX_I<-ginv(Matx_XtX)
> Matx_Xt_Y<-Matx_X_t%*%Matx_Y  
> Matx_Beta<-Matx_XtX_I%*%Matx_Xt_Y #Beta
> Matx_Beta  #Beta Matrix
            [,1]
[1,] -153.511694
[2,]    1.238723
[3,]   12.082353
> Matx_Hat_part<-Matx_X%*%Matx_XtX_I
> Matx_Hat<-Matx_Hat_part%*%Matx_X_t
> Matx_Hat  
             [,1]        [,2]        [,3]          [,4]         [,5]        [,6]
 [1,]  0.27551510  0.25153702  0.20867174  0.1676951876  0.168270450  0.06743015
 [2,]  0.25153702  0.23021233  0.19207211  0.1556134463  0.156148956  0.06641609
 [3,]  0.20867174  0.19207211  0.16587729  0.1406419863  0.136516106  0.07645031
 [4,]  0.16769519  0.15561345  0.14064199  0.1259594981  0.117634391  0.08537970
 [5,]  0.16827045  0.15614896  0.13651611  0.1176343912  0.115277661  0.07000288
 [6,]  0.06743015  0.06641609  0.07645031  0.0853796961  0.070002875  0.09890993
 [7,]  0.02267615  0.02659431  0.04929596  0.0701192641  0.049618889  0.11004898
 [8,]  0.01380782  0.01872206  0.04037249  0.0603492979  0.043506480  0.10019630
 [9,]  0.03676008  0.03916845  0.04982378  0.0596544070  0.051341743  0.07924995
[10,]  0.01816052  0.02262067  0.03816564  0.0526021348  0.042652021  0.08260982
[11,] -0.07266093 -0.05816892 -0.02122844  0.0134671922 -0.001223817  0.09061592
[12,] -0.11930364 -0.09967225 -0.04934230 -0.0020822116 -0.022358938  0.10285980
[13,] -0.04884577 -0.03691926 -0.01796597  0.0002846411  0.003076349  0.04660435
[14,] -0.04100327 -0.02992529 -0.01619083 -0.0027220248  0.004902527  0.03449662
[15,]  0.04238800  0.04433082  0.02396507  0.0058301845  0.036774129 -0.02180421
[16,]  0.04920468  0.05044650  0.01859187 -0.0099531135  0.034314075 -0.05587234
[17,] -0.04030330 -0.02919705 -0.03571681 -0.0404739774 -0.006453897 -0.03359424
             [,7]        [,8]         [,9]       [,10]        [,11]        [,12]
 [1,]  0.02267615  0.01380782  0.036760079  0.01816052 -0.072660926 -0.119303640
 [2,]  0.02659431  0.01872206  0.039168452  0.02262067 -0.058168920 -0.099672248
 [3,]  0.04929596  0.04037249  0.049823777  0.03816564 -0.021228440 -0.049342302
 [4,]  0.07011926  0.06034930  0.059654407  0.05260213  0.013467192 -0.002082212
 [5,]  0.04961889  0.04350648  0.051341743  0.04265202 -0.001223817 -0.022358938
 [6,]  0.11004898  0.10019630  0.079249955  0.08260982  0.090615921  0.102859795
 [7,]  0.13462898  0.12352035  0.090729975  0.09926328  0.129801249  0.156259596
 [8,]  0.12352035  0.11504563  0.086540787  0.09485557  0.126334476  0.151332146
 [9,]  0.09072997  0.08654079  0.072488112  0.07657873  0.092050803  0.104355519
[10,]  0.09926328  0.09485557  0.076578732  0.08268850  0.107153772  0.124915709
[11,]  0.12980125  0.12633448  0.092050803  0.10715377  0.173078265  0.214508439
[12,]  0.15625960  0.15133215  0.104355519  0.12491571  0.214508439  0.270978096
[13,]  0.06626031  0.07256541  0.065529132  0.07395176  0.116758078  0.137116722
[14,]  0.04849673  0.05744952  0.058074019  0.06454278  0.100433184  0.114698937
[15,] -0.04440081 -0.02461115  0.017631099  0.01079451 -0.005685604 -0.030513061
[16,] -0.09103661 -0.06331764 -0.001468316 -0.01243116 -0.041802164 -0.080276080
[17,] -0.04187661 -0.01666954  0.021491725  0.02087575  0.036568490  0.026523522
              [,13]        [,14]        [,15]        [,16]        [,17]
 [1,] -0.0488457732 -0.041003266  0.042388003  0.049204685 -0.040303304
 [2,] -0.0369192587 -0.029925290  0.044330819  0.050446499 -0.029197049
 [3,] -0.0179659701 -0.016190833  0.023965074  0.018591870 -0.035716814
 [4,]  0.0002846411 -0.002722025  0.005830185 -0.009953113 -0.040473977
 [5,]  0.0030763494  0.004902527  0.036774129  0.034314075 -0.006453897
 [6,]  0.0466043458  0.034496624 -0.021804210 -0.055872335 -0.033594243
 [7,]  0.0662603118  0.048496729 -0.044400811 -0.091036607 -0.041876609
 [8,]  0.0725654071  0.057449520 -0.024611147 -0.063317640 -0.016669539
 [9,]  0.0655291324  0.058074019  0.017631099 -0.001468316  0.021491725
[10,]  0.0739517606  0.064542776  0.010794510 -0.012431163  0.020875746
[11,]  0.1167580783  0.100433184 -0.005685604 -0.041802164  0.036568490
[12,]  0.1371167217  0.114698937 -0.030513061 -0.080276080  0.026523522
[13,]  0.1139093660  0.112494511  0.082972559  0.086447943  0.125759875
[14,]  0.1124945105  0.115244194  0.107367956  0.121820114  0.149820323
[15,]  0.0829725588  0.107367956  0.220997595  0.289578053  0.244384851
[16,]  0.0864479432  0.121820114  0.289578053  0.388041362  0.317712818
[17,]  0.1257598752  0.149820323  0.244384851  0.317712818  0.301148084
> print("Value of H is : ")
[1] "Value of H is : "
> Matx_SSE_basic<- Identity_Mat-Matx_Hat
> Matx_SSE_basic
             [,1]        [,2]        [,3]          [,4]         [,5]        [,6]
 [1,]  0.72448490 -0.25153702 -0.20867174 -0.1676951876 -0.168270450 -0.06743015
 [2,] -0.25153702  0.76978767 -0.19207211 -0.1556134463 -0.156148956 -0.06641609
 [3,] -0.20867174 -0.19207211  0.83412271 -0.1406419863 -0.136516106 -0.07645031
 [4,] -0.16769519 -0.15561345 -0.14064199  0.8740405019 -0.117634391 -0.08537970
 [5,] -0.16827045 -0.15614896 -0.13651611 -0.1176343912  0.884722339 -0.07000288
 [6,] -0.06743015 -0.06641609 -0.07645031 -0.0853796961 -0.070002875  0.90109007
 [7,] -0.02267615 -0.02659431 -0.04929596 -0.0701192641 -0.049618889 -0.11004898
 [8,] -0.01380782 -0.01872206 -0.04037249 -0.0603492979 -0.043506480 -0.10019630
 [9,] -0.03676008 -0.03916845 -0.04982378 -0.0596544070 -0.051341743 -0.07924995
[10,] -0.01816052 -0.02262067 -0.03816564 -0.0526021348 -0.042652021 -0.08260982
[11,]  0.07266093  0.05816892  0.02122844 -0.0134671922  0.001223817 -0.09061592
[12,]  0.11930364  0.09967225  0.04934230  0.0020822116  0.022358938 -0.10285980
[13,]  0.04884577  0.03691926  0.01796597 -0.0002846411 -0.003076349 -0.04660435
[14,]  0.04100327  0.02992529  0.01619083  0.0027220248 -0.004902527 -0.03449662
[15,] -0.04238800 -0.04433082 -0.02396507 -0.0058301845 -0.036774129  0.02180421
[16,] -0.04920468 -0.05044650 -0.01859187  0.0099531135 -0.034314075  0.05587234
[17,]  0.04030330  0.02919705  0.03571681  0.0404739774  0.006453897  0.03359424
             [,7]        [,8]         [,9]       [,10]        [,11]        [,12]
 [1,] -0.02267615 -0.01380782 -0.036760079 -0.01816052  0.072660926  0.119303640
 [2,] -0.02659431 -0.01872206 -0.039168452 -0.02262067  0.058168920  0.099672248
 [3,] -0.04929596 -0.04037249 -0.049823777 -0.03816564  0.021228440  0.049342302
 [4,] -0.07011926 -0.06034930 -0.059654407 -0.05260213 -0.013467192  0.002082212
 [5,] -0.04961889 -0.04350648 -0.051341743 -0.04265202  0.001223817  0.022358938
 [6,] -0.11004898 -0.10019630 -0.079249955 -0.08260982 -0.090615921 -0.102859795
 [7,]  0.86537102 -0.12352035 -0.090729975 -0.09926328 -0.129801249 -0.156259596
 [8,] -0.12352035  0.88495437 -0.086540787 -0.09485557 -0.126334476 -0.151332146
 [9,] -0.09072997 -0.08654079  0.927511888 -0.07657873 -0.092050803 -0.104355519
[10,] -0.09926328 -0.09485557 -0.076578732  0.91731150 -0.107153772 -0.124915709
[11,] -0.12980125 -0.12633448 -0.092050803 -0.10715377  0.826921735 -0.214508439
[12,] -0.15625960 -0.15133215 -0.104355519 -0.12491571 -0.214508439  0.729021904
[13,] -0.06626031 -0.07256541 -0.065529132 -0.07395176 -0.116758078 -0.137116722
[14,] -0.04849673 -0.05744952 -0.058074019 -0.06454278 -0.100433184 -0.114698937
[15,]  0.04440081  0.02461115 -0.017631099 -0.01079451  0.005685604  0.030513061
[16,]  0.09103661  0.06331764  0.001468316  0.01243116  0.041802164  0.080276080
[17,]  0.04187661  0.01666954 -0.021491725 -0.02087575 -0.036568490 -0.026523522
              [,13]        [,14]        [,15]        [,16]        [,17]
 [1,]  0.0488457732  0.041003266 -0.042388003 -0.049204685  0.040303304
 [2,]  0.0369192587  0.029925290 -0.044330819 -0.050446499  0.029197049
 [3,]  0.0179659701  0.016190833 -0.023965074 -0.018591870  0.035716814
 [4,] -0.0002846411  0.002722025 -0.005830185  0.009953113  0.040473977
 [5,] -0.0030763494 -0.004902527 -0.036774129 -0.034314075  0.006453897
 [6,] -0.0466043458 -0.034496624  0.021804210  0.055872335  0.033594243
 [7,] -0.0662603118 -0.048496729  0.044400811  0.091036607  0.041876609
 [8,] -0.0725654071 -0.057449520  0.024611147  0.063317640  0.016669539
 [9,] -0.0655291324 -0.058074019 -0.017631099  0.001468316 -0.021491725
[10,] -0.0739517606 -0.064542776 -0.010794510  0.012431163 -0.020875746
[11,] -0.1167580783 -0.100433184  0.005685604  0.041802164 -0.036568490
[12,] -0.1371167217 -0.114698937  0.030513061  0.080276080 -0.026523522
[13,]  0.8860906340 -0.112494511 -0.082972559 -0.086447943 -0.125759875
[14,] -0.1124945105  0.884755806 -0.107367956 -0.121820114 -0.149820323
[15,] -0.0829725588 -0.107367956  0.779002405 -0.289578053 -0.244384851
[16,] -0.0864479432 -0.121820114 -0.289578053  0.611958638 -0.317712818
[17,] -0.1257598752 -0.149820323 -0.244384851 -0.317712818  0.698851916
> Matx_SSE_basic1<-Matx_Y_t%*%Matx_SSE_basic
> Matx_SSE<-Matx_SSE_basic1%*%Matx_Y
> print("Value of SSE is : ")
[1] "Value of SSE is : "
> Matx_SSE
         [,1]
[1,] 423.3741
> J<-matrix(1, nrow=17,ncol=17) # Square matrix J
> Matx_J<-J/17 # n=17
> Matx_SSR_part<-Matx_Hat-Matx_J
> Matx_SSR<-Matx_Y_t%*%Matx_SSR_part%*%Matx_Y
> print("Value of SSR is : ")
[1] "Value of SSR is : "
> Matx_SSR
         [,1]
[1,] 12816.35
> 
> MSE<-Matx_SSE/14 # Calculate MSE
> print("Value of MSE is : ")
[1] "Value of MSE is : "
> MSE
         [,1]
[1,] 30.24101
> 
> MSR<-Matx_SSR/2 # Calculate MSR
> print("Value of MSR is : ")
[1] "Value of MSR is : "
> MSR
         [,1]
[1,] 6408.173
> 
> F0<-MSR/MSE #Calculate F0
> print("Value of F0 is : ")
[1] "Value of F0 is : "
> F0
         [,1]
[1,] 211.9034
> 